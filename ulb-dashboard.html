<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ULB Smart Waste Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
body {margin:0; font-family:'Segoe UI', Arial, sans-serif; background:#f5f8f5;}
.sidebar {
  position:fixed; top:60px; left:0; height:calc(100% - 60px); width:250px; background:#6b9e5d; color:white;
  display:flex; flex-direction:column; overflow-x:hidden; padding-top:20px; transition:width 0.3s; z-index:1000;
}
.sidebar.collapsed{width:60px;}
.sidebar .nav-link{color:white; display:flex; align-items:center; padding:12px 20px; text-decoration:none; transition:0.3s;}
.sidebar .nav-link:hover{background:#558b45; border-radius:8px;}
.sidebar .nav-link i{width:24px; min-width:24px; text-align:center; margin-right:12px;}
.sidebar.collapsed .nav-link span{display:none;}
.content{margin-left:250px; padding:20px; transition:margin-left 0.3s;}
.sidebar.collapsed ~ .content{margin-left:60px;}
header{background:#6b9e5d; color:white; padding:15px 20px; font-size:24px; font-weight:bold; position:sticky; top:0; z-index:999; display:flex; align-items:center; justify-content:space-between; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
.top-nav {display:flex; gap:15px;}
.top-nav button{background:none; border:none; color:white; font-size:18px; cursor:pointer; display:flex; flex-direction:column; align-items:center;}
.top-nav button span{font-size:12px; margin-top:2px;}
.section-card{background:white; border-radius:12px; padding:20px; box-shadow:0 4px 10px rgba(0,0,0,0.1); margin-bottom:30px; display:none;}
.section-card.active{display:block;}
table th, table td{text-align:center;}
.toast-container{position:fixed; top:1rem; right:1rem; z-index:1055;}
</style>
</head>
<body>

<!-- Header with top nav -->
<header>
  ULB Smart Waste Dashboard
  <div class="top-nav">
    <button data-target="vehicles"><i class="fas fa-truck"></i><span>Vehicles</span></button>
    <button data-target="disposers"><i class="fas fa-industry"></i><span>Disposers</span></button>
    <button data-target="complaints"><i class="fas fa-exclamation-triangle"></i><span>Complaints</span></button>
    <button data-target="fines"><i class="fas fa-balance-scale"></i><span>Fines</span></button>
    <button data-target="dashboard"><i class="fas fa-chart-bar"></i><span>Dashboard</span></button>
  </div>
</header>

<!-- Sidebar -->
<nav class="sidebar" id="sidebar">
  <button class="btn btn-sm btn-light mb-3 align-self-end" id="toggleSidebar"><i class="fas fa-bars"></i></button>
  <a href="#" class="nav-link" data-target="vehicles"><i class="fas fa-truck"></i><span>Vehicle Tracking</span></a>
  <a href="#" class="nav-link" data-target="disposers"><i class="fas fa-industry"></i><span>Waste Disposers</span></a>
  <a href="#" class="nav-link" data-target="complaints"><i class="fas fa-exclamation-triangle"></i><span>Validate Complaints</span></a>
  <a href="#" class="nav-link" data-target="fines"><i class="fas fa-balance-scale"></i><span>Fines & Rewards</span></a>
  <a href="#" class="nav-link" data-target="dashboard"><i class="fas fa-chart-bar"></i><span>Real-time Dashboard</span></a>
</nav>

<div class="content">
<!-- Sections -->
<div id="vehicles" class="section-card active">
  <h2>üöõ Vehicle Tracking</h2>
  <table class="table table-bordered">
    <thead><tr><th>Vehicle ID</th><th>Driver</th><th>Status</th><th>Waste Type</th><th>Last Location</th></tr></thead>
    <tbody id="vehicleTable"></tbody>
  </table>
</div>

<div id="disposers" class="section-card">
  <h2>üè≠ Waste Disposers</h2>
  <table class="table table-bordered">
    <thead><tr><th>Facility</th><th>Capacity Used</th><th>Status</th></tr></thead>
    <tbody id="disposerTable"></tbody>
  </table>
</div>

<div id="complaints" class="section-card">
  <h2>‚ö†Ô∏è Validate Complaints</h2>
  <table class="table table-bordered">
    <thead><tr><th>Complaint ID</th><th>User</th><th>Description</th><th>Status</th><th>Action</th></tr></thead>
    <tbody id="complaintTable"></tbody>
  </table>
</div>

<div id="fines" class="section-card">
  <h2>‚öñÔ∏è Fines & Rewards</h2>
  <ul id="fineRewardList"></ul>
</div>

<div id="dashboard" class="section-card">
  <h2>üìä Real-time Dashboard</h2>
  <canvas id="realtimeChart"></canvas>
</div>
</div>

<div class="toast-container" id="toastContainer"></div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Sidebar toggle
const sidebar = document.getElementById('sidebar');
document.getElementById('toggleSidebar').addEventListener('click',()=>{sidebar.classList.toggle('collapsed');});

// Section switch (both top nav & sidebar)
const navLinks = document.querySelectorAll('.sidebar .nav-link, .top-nav button');
const sections = document.querySelectorAll('.section-card');
navLinks.forEach(link=>{
  link.addEventListener('click', e=>{
    e.preventDefault();
    const target = link.dataset.target;
    sections.forEach(sec=>sec.classList.remove('active'));
    document.getElementById(target).classList.add('active');
  });
});

// Toast function
function showToast(msg,type='success'){
  const toastContainer = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.className = `toast align-items-center text-bg-${type} border-0 show mb-2`;
  toast.innerHTML = `<div class="d-flex"><div class="toast-body">${msg}</div>
    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div>`;
  toastContainer.appendChild(toast);
  setTimeout(()=>toast.remove(),3000);
}

// Sample Data
let vehicles = [
  {id:'V001', driver:'Ramesh', status:'On Route', waste:'Segregated', location:'Street A'},
  {id:'V002', driver:'Sita', status:'Idle', waste:'Mixed', location:'Depot'},
  {id:'V003', driver:'Mahesh', status:'Completed', waste:'Segregated', location:'Recycle Center'}
];

let disposers = [
  {facility:'Composting Plant', capacity:75, status:'Operational'},
  {facility:'Recycling Plant', capacity:60, status:'Operational'},
  {facility:'Dumping Yard', capacity:90, status:'Full'}
];

let complaints = [
  {id:'C001', user:'John', desc:'Illegal dumping', status:'Pending'},
  {id:'C002', user:'Mary', desc:'Bin not collected', status:'Pending'}
];

let finesRewards = [
  'Fine ‚Çπ500 for littering at Street B',
  'Reward: Compost Kit to GreenVille Society'
];

// Populate tables
function updateTables(){
  const vTable = document.getElementById('vehicleTable');
  vTable.innerHTML='';
  vehicles.forEach(v=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${v.id}</td><td>${v.driver}</td><td>${v.status}</td><td>${v.waste}</td><td>${v.location}</td>`;
    vTable.appendChild(tr);
  });

  const dTable = document.getElementById('disposerTable');
  dTable.innerHTML='';
  disposers.forEach(d=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${d.facility}</td><td>${d.capacity}%</td><td>${d.status}</td>`;
    dTable.appendChild(tr);
  });

  const cTable = document.getElementById('complaintTable');
  cTable.innerHTML='';
  complaints.forEach((c,index)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${c.id}</td><td>${c.user}</td><td>${c.desc}</td><td>${c.status}</td>
      <td><button class="btn btn-success btn-sm" onclick="validateComplaint(${index})">Validate</button></td>`;
    cTable.appendChild(tr);
  });

  const frList = document.getElementById('fineRewardList');
  frList.innerHTML='';
  finesRewards.forEach(f=>{ const li=document.createElement('li'); li.textContent=f; frList.appendChild(li); });
}
updateTables();

// Validate Complaint
function validateComplaint(index){
  complaints[index].status='Validated';
  showToast(`Complaint ${complaints[index].id} validated`);
  updateTables();
}

// Real-time chart
const ctx = document.getElementById('realtimeChart').getContext('2d');
const realtimeChart = new Chart(ctx,{
  type:'bar',
  data:{
    labels:['Vehicle Usage','Segregated Waste %','Pending Complaints','Fines Issued'],
    datasets:[{label:'Metrics', data:[85,75,2,500], backgroundColor:['#6b9e5d','#81c784','#ff7043','#64b5f6'] }]
  },
  options:{ responsive:true, plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true, max:1000}} }
});

// Simulate updates
setInterval(()=>{
  vehicles.forEach(v=>{
    if(Math.random()>0.5) v.status='On Route'; else v.status='Idle';
    v.waste=Math.random()>0.5?'Segregated':'Mixed';
    v.location=`Street ${String.fromCharCode(65+Math.floor(Math.random()*5))}`;
  });
  disposers.forEach(d=>{
    d.capacity=Math.min(100, Math.max(0, d.capacity + (Math.random()*10-5)));
  });
  updateTables();
  realtimeChart.data.datasets[0].data=[
    vehicles.filter(v=>v.status=='On Route').length*30,
    vehicles.filter(v=>v.waste=='Segregated').length*30,
    complaints.filter(c=>c.status=='Pending').length*30,
    finesRewards.length*100
  ];
  realtimeChart.update();
},5000);
</script>
</body>
</html>
